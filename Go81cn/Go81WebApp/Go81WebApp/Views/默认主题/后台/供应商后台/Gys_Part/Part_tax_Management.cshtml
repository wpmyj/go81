@model Go81WebApp.Models.数据模型.用户数据模型.供应商
<link href="~/css/css.css" rel=" stylesheet" />
<link href="~/css/Msg_Tips.css" rel="stylesheet" />
<script type="text/javascript" src="~/JS/My97DatePicker/calendar.js"></script>
<script type="text/javascript" src="~/JS/My97DatePicker/config.js"></script>
<script type="text/javascript" src="~/JS/My97DatePicker/WdatePicker.js"></script>
<div id="f1" class="modal_out">
    <div class="modal_in"></div>
    <div class="modal_content_loading">
        <img src="~/Images/ajax-loader.gif" />
        <span>正在上传，请稍等...</span>
    </div>
</div>
<style>
     td {
        position: relative;
    }

    div.out_box {
        width: 135px;
        left: initial;
    }
</style>
<div id="picture" style="position:absolute; text-align:center; width:auto; height:auto; background-color:green; box-shadow:0px 0px 10px black;-webkit-box-shadow:0px 0px 10px black;-moz-box-shadow:0px 0px 10px black; margin:50px auto 0px auto;z-index:100;visibility:hidden;">
    <div style="width:100%; text-align:right;">
        <a style="cursor:pointer;  background-color:white; width:50px; height:25px;" onclick="hidePic()">关闭</a>
    </div>
    <img src="" />
</div>
<div id="title_div" class="gys_xttz_topbg">
    <div class="index_bottom_zb_top_title">
        税务信息
        @if (Model.供应商用户信息.已提交)
        {
            <span style="font-size:15px; color:red;"><em>您已提交过申请，不能修改信息。如需修改信息，请联系网站管理员。</em></span>
        }
    </div>
</div>
<div style="border:1px solid green; margin-top:8px;">
    @using (Html.BeginForm("Tax_Manage", "供应商后台", FormMethod.Post, new { enctype = "multipart/form-data", name = "ax" }))
    {
        <div class="company_msg">
            @Html.HiddenFor(m => m.Id)
            <div style="font-size:14px;">
                <table width="100%">
                    <tr>
                        <td width="25%" align="right">国税税务登记证号：</td>
                        <td width="25%">
                            @Html.EditorFor(m => m.税务信息.国税税务登记证号)
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写国税登记号</div>
                            </div>
                            @Html.ValidationMessageFor(m => m.税务信息.国税税务登记证号)
                            @if (string.IsNullOrWhiteSpace(Model.税务信息.国税税务登记证号))
                            {
                                <span style="color:red;">*必需</span>
                            }
                        </td>
                        <td width="25%" align="right">国税税务登记证发证机关：</td>
                        <td width="25%">
                            @Html.EditorFor(m => m.税务信息.国税税务登记证发证机关)
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写国税税务登记证发证机关,如四川省国税局</div>
                            </div>
                            @Html.ValidationMessageFor(m => m.税务信息.国税税务登记证发证机关)
                            @if (string.IsNullOrWhiteSpace(Model.税务信息.国税税务登记证发证机关))
                            {
                                <span style="color:red;">*必需</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <td align="right">国税税务登记证有效期类型：</td>
                        <td>
                            @Html.EnumDropDownListFor(m => m.税务信息.国税税务登记证有效期类型, new { @style = "width:154px; margin-left:2px;", onclick = "disabled_txt(this,'#gtax')" })
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请选择国税登记有效期类型</div>
                            </div>
                            <br />@Html.ValidationMessageFor(m => m.税务信息.国税税务登记证有效期类型)
                        </td>
                        <td align="right">国税税务登记证有效期起始日期：</td>
                        <td>
                            @Html.TextBoxFor(m => m.税务信息.国税税务登记证有效期起始日期, new { onfocus = "WdatePicker({dateFmt:'yyyy/MM/dd'})" })
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写国税税务登记证有效期起始日期,如2014/02/03</div>
                            </div>
                            @Html.ValidationMessageFor(m => m.税务信息.国税税务登记证有效期起始日期)
                        </td>
                    </tr>
                    <tr>
                        @*<td align="right">国税税务登记证有效期结束日期：</td>
                            <td>
                                @Html.TextBoxFor(m => m.税务信息.国税税务登记证有效期结束日期, new { id = "gtax", onfocus = "WdatePicker({dateFmt:'yyyy/MM/dd'})" })
                                <div class="out_box">
                                    <div class="arrow"></div>
                                    <div class="con_box">请填写国税税务登记证有效期结束日期,如2014/02/03</div>
                                </div>
                                @Html.ValidationMessageFor(m => m.税务信息.国税税务登记证有效期结束日期)
                            </td>*@
                        <td align="right"> 地税税务登记证号：</td>
                        <td>
                            @Html.EditorFor(m => m.税务信息.地税税务登记证号)
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写地税税务登记证号</div>
                            </div>
                            @Html.ValidationMessageFor(m => m.税务信息.地税税务登记证号)
                            @if (string.IsNullOrWhiteSpace(Model.税务信息.地税税务登记证号))
                            {
                                <span style="color:red;">*必需</span>
                            }
                        </td>
                        <td align="right">地税税务登记证发证机关：</td>
                        <td>
                            @Html.EditorFor(m => m.税务信息.地税税务登记证发证机关)
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写地税税务登记证发证机关,如四川省地税局</div>
                            </div>
                            @Html.ValidationMessageFor(m => m.税务信息.地税税务登记证发证机关)
                            @if (string.IsNullOrWhiteSpace(Model.税务信息.地税税务登记证发证机关))
                            {
                                <span style="color:red;">*必需</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <td align="right">地税税务登记证有效期类型：</td>
                        <td>
                            @Html.EnumDropDownListFor(m => m.税务信息.地税税务登记证有效期类型, new { @style = "width:154px; margin-left:2px;", onclick = "disabled_txt(this,'#dtax')" })
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请选择地税税务登记证有效期类型</div>
                            </div>
                            <br />@Html.ValidationMessageFor(m => m.税务信息.地税税务登记证有效期类型)
                        </td>
                        <td align="right">地税税务登记证有效期起始日期：</td>
                        <td>
                            @Html.TextBoxFor(m => m.税务信息.地税税务登记证有效期起始日期, new { @style = "margin-left:2px;", onfocus = "WdatePicker({dateFmt:'yyyy/MM/dd'})" })
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请填写地税税务登记证有效期起始日期,如2013/02/05</div>
                            </div>
                            <br />@Html.ValidationMessageFor(m => m.税务信息.地税税务登记证有效期起始日期)
                        </td>
                    </tr>
                    <tr>
                        <td align="right">
                            @Html.CheckBoxFor(m => m.税务信息.近3年完税证明, new { onmouseover = "showdiv(this)", onmouseout = "hidediv(this)" })
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">已完税，请勾选，否则不用勾选</div>
                            </div>
                        </td>
                        <td>
                            近3年是否完税
                        </td>
                        @*<td align="right">地税税务登记证有效期结束日期：</td>
                            <td>
                                @Html.TextBoxFor(m => m.税务信息.地税税务登记证有效期结束日期, new { id = "dtax", @style = "margin-left:2px;", onfocus = "WdatePicker({dateFmt:'yyyy/MM/dd'})" })
                                <div class="out_box">
                                    <div class="arrow"></div>
                                    <div class="con_box">请填写地税税务登记证有效期结束日期,如2013/02/05</div>
                                </div>
                                <br />@Html.ValidationMessageFor(m => m.税务信息.地税税务登记证有效期结束日期)
                            </td>*@
                    </tr>
                </table>
            </div>
        </div>
    }
    <div>
        <form action="/供应商后台/SavePicture" method="post" name="upload" enctype="multipart/form-data" target="showPic">
            <input type="hidden" value="tax" name="pic1" />
            <table width="90%" style="font-size:14px; margin-left:30px;">
                <tr>
                    <td style="width:93px;" align="right">近3年完税证明电子扫描件：</td>
                    <td style="width:300px;">
                        @if (System.IO.File.Exists(Server.MapPath(@Model.税务信息.近3年完税证明电子扫描件)))
                        {
                            <span>
                                <a title="点击查看大图" href="@Model.税务信息.近3年完税证明电子扫描件" target="_blank" style="color:red; margin-right:30px; text-decoration:underline;"><img src="@Model.税务信息.近3年完税证明电子扫描件" width="50" height="30" /></a>
                                @if (!Model.供应商用户信息.已提交)
                                {
                                    <a href="###" style="color:red; margin-right:30px; text-decoration:underline;" onclick="showButton(this,'file1','#bt1')">修改</a>
                                }
                            </span>
                            if (!Model.供应商用户信息.已提交)
                            {
                                <input type="file" onchange="fileChange()" style="display:none;width:72px;" accept="image/jpeg" multiple="multiple" name="file1" />
                            }
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请选择并上传税务信息.近3年完税证明电子扫描件。<em style="color:red;">注：请上传2M以下的jpg格式的彩色扫描件图片</em></div>
                            </div>
                        }
                        else
                        {
                            <span style="color:red;">
                                您还没有上传税务信息.近3年完税证明电子扫描件
                                @if (!Model.供应商用户信息.已提交)
                                {
                                    <a href="###" style="color:red; margin-right:30px; text-decoration:underline;" onclick="showButton(this, 'file1', '#bt1')">【点击添加】</a>
                                }
                            </span>
                            if (!Model.供应商用户信息.已提交)
                            {
                                <input type="file" onchange="fileChange()" style="display:none;width:72px;" accept="image/jpeg" multiple="multiple" name="file1" size="40" />
                            }
                            <div class="out_box">
                                <div class="arrow"></div>
                                <div class="con_box">请选择并上传税务信息.近3年完税证明电子扫描件。<em style="color:red;">注：请上传2M以下的jpg格式的彩色扫描件图片</em></div>
                            </div>
                        }
                    </td>
                </tr>
            </table>
        </form>
        <div id="framebox" style="display:none; margin-left:150px; width:700px; margin-right:auto;">
            <iframe name="showPic" id="showPic" frameborder="0" height="150" width="100%"></iframe>
        </div>
    </div>
</div>
@if (!Model.供应商用户信息.已提交)
{
    <table><tr><td style="display:block;height:50px; text-align:center; width:900px;"><input type="button" id="submit_btn" onclick="submitForm()" value="保  存" /><a style="margin-left:20px; width:100px; height:35px; line-height:35px; background-color:#2c5735; color:white; display:inline-block; cursor:pointer;" class="modify">修  改</a></td></tr></table>
}
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $("a.modify").click(function () { $(".company_msg :text,.company_msg select,.company_msg :checkbox,.company_msg :file,#submit_btn").each(function () { $(this).removeAttr("disabled"); }); $("#submit_btn").css("background-color", "#2c5735"); $("input[type='file']").each(function () { $(this).removeAttr("disabled"); }); });
        $("table tr td :input").mouseover(function () { $(this).next("div").show(); $(this).next("div").css("display", "inline-block"); });
        $("table tr td :input").mouseout(function () { $(this).next("div").hide(); });
        $("#税务信息").css({ "background": "#537E2B" }).children("a").css({ "color": "#fff" });
        $("#税务信息").parents().attr("show", "true").show().prev("li").addClass("open").children("span").css({ "background": "url('../Images/tree_icons.png') -115px -4px" });
    });
    function submitForm() {
        $("form[name='ax']").submit();
    }
    function showButton(th, str, str1) {
        $(":file[name='" + str + "']").show();
        $(str1).show();
        $(th).hide();
    }
    function fileChange() {
        document.forms["upload"].submit();
        $("#f1").show();
        $("#framebox").show();
        $(target).prev("span").hide();
    }
    function disabled_txt(th, str) {
        if ($(th).val() == 1 || $(th).val() == 0) {
            $(str).attr("disabled", "disabled");
        }
        else {
            $(str).removeAttr("disabled");
        }
    }
    function showPic(th) {
        $("#picture img").attr("src", th.title);
        $("#picture").css("visibility", "visible");
    }
    function hidePic() {
        $("#picture").css("visibility", "hidden");
    }
    function showdiv(th) {
        $(th).parent().children("div").show();
        $(th).parent().children("div").css("display", "inline-block");
    }
    function hidediv(th) {
        $(th).parent().children("div").hide();
    }
</script>
<script type="text/javascript" language="javascript">
    $(".company_msg :text,.company_msg select,.company_msg textarea,.company_msg :checkbox,.company_msg :file,#submit_btn").each(function () { $(this).attr("disabled", "disabled"); $(this).css("background-color", "white"); });
</script>
